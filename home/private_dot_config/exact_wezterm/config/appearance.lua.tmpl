---@type Wezterm
local wezterm = require("wezterm")

local colors = {
  rosewater = "#f5e0dc",
  flamingo = "#f2cdcd",
  pink = "#f5c2e7",
  mauve = "#cba6f7",
  red = "#f38ba8",
  maroon = "#eba0ac",
  peach = "#fab387",
  yellow = "#f9e2af",
  green = "#a6e3a1",
  teal = "#94e2d5",
  sky = "#89dceb",
  sapphire = "#74c7ec",
  blue = "#89b4fa",
  lavender = "#b4befe",
  text = "#cdd6f4",
  subtext1 = "#bac2de",
  subtext0 = "#a6adc8",
  overlay2 = "#9399b2",
  overlay1 = "#7f849c",
  overlay0 = "#6c7086",
  surface2 = "#585b70",
  surface1 = "#45475a",
  surface0 = "#313244",
  base = "#1E1E2E",
  mantle = "#181825",
  crust = "#11111b",
}

local M = {}

---@param config Config
function M.setup(config)
  local font_size = tonumber("{{- .font.size -}}")

  -- Font
  config.font = wezterm.font_with_fallback({
    {
      family = "{{ .font.mono.family }}",
      weight = "{{ .font.mono.weight }}",
    },
    "{{ .font.icon.family }}",
  })
  config.font_size = font_size
  config.command_palette_font_size = font_size
  config.line_height = 1.2

  -- Colors
  config.color_scheme = "Catppuccin Mocha"
  config.window_background_gradient = {
    orientation = "Vertical",
    colors = { colors.base, colors.surface0, colors.crust },
    interpolation = "Linear",
  }
  config.command_palette_bg_color = colors.surface0
  config.command_palette_fg_color = colors.text

  -- Rendering
  config.animation_fps = 144
  config.max_fps = 144

  config.underline_thickness = 3
  config.cursor_thickness = 4
  config.underline_position = -6

  -- Cursor
  -- {{- if eq .device_type "desktop" }}
  config.cursor_blink_ease_in = "Constant"
  config.cursor_blink_ease_out = "Constant"
  config.cursor_blink_rate = 700
  -- {{- end }}
  config.scrollback_lines = 10000

  -- Window
  config.window_decorations = "INTEGRATED_BUTTONS|RESIZE"
  config.window_padding = {
    top = 0,
    bottom = 0,
    left = 0,
    right = 0,
  }
  config.enable_scroll_bar = false

  -- Tab Bar
  config.show_tab_index_in_tab_bar = false
  config.switch_to_last_active_tab_when_closing_tab = true
  config.window_frame = {
    font = wezterm.font_with_fallback({
      {
        family = "{{ .font.sans.family }}",
        weight = "Bold",
      },
      "{{ .font.icon.family }}",
    }),
    active_titlebar_bg = colors.base,
    inactive_titlebar_bg = colors.base,
  }
end

return M
